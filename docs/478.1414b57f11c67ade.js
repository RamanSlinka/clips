(self.webpackChunkclips=self.webpackChunkclips||[]).push([[478],{891:(_,y,a)=>{const v=a(5313),{devDependencies:p}=a(3681);_.exports={corePath:typeof process<"u"&&"development"===process.env.FFMPEG_ENV?v("/node_modules/@ffmpeg/core/dist/ffmpeg-core.js"):`https://unpkg.com/@ffmpeg/core@${p["@ffmpeg/core"].substring(1)}/dist/ffmpeg-core.js`}},2060:(_,y,a)=>{var v=a(7156).default;const p=a(5313);_.exports=function(){var d=v(function*(e){let h=e;return typeof e>"u"?new Uint8Array:("string"==typeof e?h=/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?atob(e.split(",")[1]).split("").map(b=>b.charCodeAt(0)):yield(yield fetch(p(e))).arrayBuffer():(e instanceof File||e instanceof Blob)&&(h=yield(d=>new Promise((e,h)=>{const b=new FileReader;b.onload=()=>{e(b.result)},b.onerror=({target:{error:{code:g}}})=>{h(Error(`File could not be read! Code=${g}`))},b.readAsArrayBuffer(d)}))(e)),new Uint8Array(h))});return function(e){return d.apply(this,arguments)}}()},2038:(_,y,a)=>{var v=a(7156).default;const p=a(5313),{log:m}=a(9905),d=function(){var e=v(function*(h,b){m("info",`fetch ${h}`);const g=yield(yield fetch(h)).arrayBuffer();m("info",`${h} file size = ${g.byteLength} bytes`);const w=new Blob([g],{type:b}),M=URL.createObjectURL(w);return m("info",`${h} blob URL = ${M}`),M});return function(b,g){return e.apply(this,arguments)}}();_.exports=function(){var e=v(function*({corePath:h}){if("string"!=typeof h)throw Error("corePath should be a string!");const b=p(h),g=yield d(b,"application/javascript"),w=yield d(b.replace("ffmpeg-core.js","ffmpeg-core.wasm"),"application/wasm"),M=yield d(b.replace("ffmpeg-core.js","ffmpeg-core.worker.js"),"application/javascript");return typeof createFFmpegCore>"u"?new Promise(k=>{const P=document.createElement("script"),Y=()=>{P.removeEventListener("load",Y),m("info","ffmpeg-core.js script loaded"),k({createFFmpegCore,corePath:g,wasmPath:w,workerPath:M})};P.src=g,P.type="text/javascript",P.addEventListener("load",Y),document.getElementsByTagName("head")[0].appendChild(P)}):(m("info","ffmpeg-core.js script is loaded already"),Promise.resolve({createFFmpegCore,corePath:g,wasmPath:w,workerPath:M}))});return function(h){return e.apply(this,arguments)}}()},8103:(_,y,a)=>{const v=a(891),p=a(2038),m=a(2060);_.exports={defaultOptions:v,getCreateFFmpegCore:p,fetchFile:m}},2999:_=>{_.exports={defaultArgs:["./ffmpeg","-nostdin","-y"],baseOptions:{log:!1,logger:()=>{},progress:()=>{},corePath:""}}},389:(_,y,a)=>{var v=a(7156).default;const{defaultArgs:p,baseOptions:m}=a(2999),{setLogging:d,setCustomLogger:e,log:h}=a(9905),b=a(1898),g=a(1192),{defaultOptions:w,getCreateFFmpegCore:M}=a(8103),{version:k}=a(3681),P=Error("ffmpeg.wasm is not ready, make sure you have completed load().");_.exports=(Y={})=>{const{log:ee,logger:B,progress:R,...V}={...m,...w,...Y};let G=null,D=null,O=null,N=!1,j=R;const $=({type:U,message:F})=>{h(U,F),b(F,j),(U=>{"FFMPEG_END"===U&&null!==O&&(O(),O=null,N=!1)})(F)},H=function(){var U=v(function*(){if(h("info","load ffmpeg-core"),null!==G)throw Error("ffmpeg.wasm was loaded, you should not load it again, use ffmpeg.isLoaded() to check next time.");{h("info","loading ffmpeg-core");const{createFFmpegCore:F,corePath:o,workerPath:n,wasmPath:s}=yield M(V);G=yield F({mainScriptUrlOrBlob:o,printErr:f=>$({type:"fferr",message:f}),print:f=>$({type:"ffout",message:f}),locateFile:(f,c)=>{if(typeof window<"u"){if(typeof s<"u"&&f.endsWith("ffmpeg-core.wasm"))return s;if(typeof n<"u"&&f.endsWith("ffmpeg-core.worker.js"))return n}return c+f}}),D=G.cwrap("proxy_main","number",["number","number"]),h("info","ffmpeg-core loaded")}});return function(){return U.apply(this,arguments)}}();return d(ee),e(B),h("info",`use ffmpeg.wasm v${k}`),{setProgress:U=>{j=U},setLogger:U=>{e(U)},setLogging:d,load:H,isLoaded:()=>null!==G,run:(...U)=>{if(h("info",`run ffmpeg command: ${U.join(" ")}`),null===G)throw P;if(N)throw Error("ffmpeg.wasm can only run one command at a time");return N=!0,new Promise(F=>{const o=[...p,...U].filter(n=>0!==n.length);O=F,D(...g(G,o))})},FS:(U,...F)=>{if(h("info",`run FS.${U} ${F.map(o=>"string"==typeof o?o:`<${o.length} bytes binary file>`).join(" ")}`),null===G)throw P;{let o=null;try{o=G.FS[U](...F)}catch{throw Error("readdir"===U?`ffmpeg.FS('readdir', '${F[0]}') error. Check if the path exists, ex: ffmpeg.FS('readdir', '/')`:"readFile"===U?`ffmpeg.FS('readFile', '${F[0]}') error. Check if the path exists`:"Oops, something went wrong in FS operation.")}return o}}}}},5200:(_,y,a)=>{a(7303);const v=a(389),{fetchFile:p}=a(8103);_.exports={createFFmpeg:v,fetchFile:p}},9905:_=>{let y=!1,a=()=>{};_.exports={logging:y,setLogging:d=>{y=d},setCustomLogger:d=>{a=d},log:(d,e)=>{a({type:d,message:e}),y&&console.log(`[${d}] ${e}`)}}},1192:_=>{_.exports=(y,a)=>{const v=y._malloc(a.length*Uint32Array.BYTES_PER_ELEMENT);return a.forEach((p,m)=>{const d=y._malloc(p.length+1);y.writeAsciiToMemory(p,d),y.setValue(v+Uint32Array.BYTES_PER_ELEMENT*m,d,"i32")}),[a.length,v]}},1898:_=>{let y=0,a=0;const v=p=>{const[m,d,e]=p.split(":");return 60*parseFloat(m)*60+60*parseFloat(d)+parseFloat(e)};_.exports=(p,m)=>{if("string"==typeof p)if(p.startsWith("  Duration")){const d=p.split(", ")[0].split(": ")[1],e=v(d);m({duration:e,ratio:a}),(0===y||y>e)&&(y=e)}else if(p.startsWith("frame")||p.startsWith("size")){const d=p.split("time=")[1].split(" ")[0],e=v(d);a=e/y,m({ratio:a,time:e})}else p.startsWith("video:")&&(m({ratio:1}),y=0)}},4478:(_,y,a)=>{"use strict";a.r(y),a.d(y,{VideoModule:()=>Ue});var v=a(6814),p=a(8076),m=a(5861),d=a(5619),e=a(5879),h=a(1591),b=a(4918),g=a(6223),w=a(8105),M=a(1060),k=a(5193);function P(r,l){if(1&r&&(e.TgZ(0,"app-alert",9)(1,"p"),e._uU(2),e.qZA()()),2&r){const t=e.oxw();e.Q6J("color",t.alertColor),e.xp6(2),e.Oqu(t.alertMessage)}}const Y=function(r,l){return{"opacity-50":r,"hover:bg-indigo-700":l}};let ee=(()=>{class r{constructor(t,i){this.modal=t,this.clipService=i,this.activeClip=null,this.update=new e.vpe,this.inSubmission=!1,this.showAlert=!1,this.alertColor="blue",this.alertMessage="Please wait! Updating clip.",this.clipID=new g.NI(""),this.title=new g.NI("",[g.kI.required,g.kI.minLength(3)]),this.editForm=new g.cw({title:this.title,id:this.clipID})}ngOnInit(){this.modal.register("editClip")}ngOnDestroy(){this.modal.unregister("editClip")}ngOnChanges(){this.activeClip&&(this.inSubmission=!1,this.showAlert=!1,this.clipID.setValue(this.activeClip.docID),this.title.setValue(this.activeClip.title))}submit(){var t=this;return(0,m.Z)(function*(){if(t.activeClip){t.inSubmission=!0,t.showAlert=!0,t.alertColor="blue",t.alertMessage="Please wait! Updating clip.";try{yield t.clipService.updateClip(t.clipID.value,t.title.value)}catch{return t.inSubmission=!1,t.alertColor="red",void(t.alertMessage="Something went wrong. Try again later.")}t.activeClip.title=t.title.value,t.update.emit(t.activeClip),t.inSubmission=!1,t.alertColor="green",t.alertMessage="Success!."}})()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(b.Z),e.Y36(h.Y))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-edit"]],inputs:{activeClip:"activeClip"},outputs:{update:"update"},features:[e.TTD],decls:12,vars:8,consts:[["modalID","editClip"],[1,"text-2xl","font-bold"],[3,"color",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"mt-4"],[1,"block","text-xl","mb-4"],["placeholder","Enter Title",3,"control"],[1,"mt-4","text-right"],["type","submit",1,"inline-flex","justify-center","py-2","px-4","border","border-transparent","shadow-sm","rounded-md","text-white","bg-indigo-600","focus:outline-none",3,"disabled","ngClass"],[3,"color"]],template:function(t,i){1&t&&(e.TgZ(0,"app-modal",0)(1,"p",1),e._uU(2,"Edit Video"),e.qZA(),e.YNc(3,P,3,2,"app-alert",2),e.TgZ(4,"form",3),e.NdJ("ngSubmit",function(){return i.submit()}),e.TgZ(5,"div",4)(6,"label",5),e._uU(7,"Title"),e.qZA(),e._UZ(8,"app-input",6),e.qZA(),e.TgZ(9,"div",7)(10,"button",8),e._uU(11," Update "),e.qZA()()()()),2&t&&(e.xp6(3),e.Q6J("ngIf",i.showAlert),e.xp6(1),e.Q6J("formGroup",i.editForm),e.xp6(4),e.Q6J("control",i.title),e.xp6(2),e.Q6J("disabled",i.inSubmission)("ngClass",e.WLB(5,Y,i.inSubmission,!i.inSubmission)))},dependencies:[v.mk,v.O5,w.z,M.a,k.w,g._Y,g.JL,g.sg]}),r})();const B=function(r){return["/","clip",r]};function R(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",10)(1,"a",11),e._UZ(2,"img",12),e.qZA(),e.TgZ(3,"div",13)(4,"a",14),e._uU(5),e.qZA(),e.TgZ(6,"a",15),e.NdJ("click",function(u){const S=e.CHM(t).$implicit,A=e.oxw();return e.KtG(A.copyToClipboard(u,S.docID))}),e._uU(7," Copy Link "),e.qZA()(),e.TgZ(8,"div",16)(9,"a",17),e.NdJ("click",function(u){const S=e.CHM(t).$implicit,A=e.oxw();return e.KtG(A.openModal(u,S))}),e.TgZ(10,"span",18),e._uU(11,"build"),e.qZA()(),e.TgZ(12,"a",19),e.NdJ("click",function(u){const S=e.CHM(t).$implicit,A=e.oxw();return e.KtG(A.deleteClip(u,S))}),e.TgZ(13,"span",18),e._uU(14,"delete"),e.qZA()()()()}if(2&r){const t=l.$implicit;e.xp6(2),e.Q6J("src",t.screenshotURL,e.LSH),e.xp6(2),e.Q6J("routerLink",e.VKq(3,B,t.docID)),e.xp6(1),e.hij(" ",t.title," ")}}let V=(()=>{class r{constructor(t,i,u,C){this.router=t,this.route=i,this.clipService=u,this.modal=C,this.videoOrder="1",this.clips=[],this.activeClip=null,this.sort$=new d.X(this.videoOrder)}ngOnInit(){this.route.queryParams.subscribe(t=>{this.videoOrder="2"===t.sort?t.sort:"1",this.sort$.next(this.videoOrder)}),this.clipService.getUserClips(this.sort$).subscribe(t=>{this.clips=[],t.forEach(i=>{this.clips.push({docID:i.id,...i.data()})})})}sort(t){const{value:i}=t.target;this.router.navigate([],{relativeTo:this.route,queryParams:{sort:i}})}openModal(t,i){t.preventDefault(),this.activeClip=i,this.modal.toggleModal("editClip")}update(t){this.clips.forEach((i,u)=>{i.docID==t.docID&&(this.clips[u].title=t.title)})}deleteClip(t,i){t.preventDefault(),this.clipService.deleteClip(i),this.clips.forEach((u,C)=>{u.docID==i.docID&&this.clips.splice(C,1)})}copyToClipboard(t,i){return(0,m.Z)(function*(){if(t.preventDefault(),!i)return;const u=`${location.origin}/clip/${i}`;yield navigator.clipboard.writeText(u),alert("Link Copied!")})()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.F0),e.Y36(p.gz),e.Y36(h.Y),e.Y36(b.Z))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-manage"]],decls:13,vars:4,consts:[[1,"container","mx-auto","my-8","bg-secondary","p-6"],[1,"rounded","relative","flex","justify-between"],["routerLink","/upload",1,"bg-indigo-400","text-white","py-4","px-10","text-xl"],[1,"text-black","px-8","text-xl","outline-none","appearance-none",3,"change"],["value","1",3,"selected"],["value","2",3,"selected"],[1,"container","mx-auto","my-8"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-4"],["class","mt-6 rounded-tl-2xl rounded-br-2xl shadow-xl bg-secondary flex flex-col justify-start",4,"ngFor","ngForOf"],[3,"activeClip","update"],[1,"mt-6","rounded-tl-2xl","rounded-br-2xl","shadow-xl","bg-secondary","flex","flex-col","justify-start"],["href","#"],["crossorigin","",1,"card-img-top","rounded-tl-2xl","w-full",3,"src"],[1,"p-6","text-2xl"],[1,"font-bold","mb-2",3,"routerLink"],["href","#",1,"bg-gray-400","text-white","px-2","py-1","ml-2","text-sm","rounded",3,"click"],[1,"flex","text-center","text-2xl","bg-gray-800","p-2","mt-auto"],["href","#",1,"flex-1","p-2","border-right","border-r-2","border-gray-700","transition","hover:text-indigo-400",3,"click"],[1,"material-icons","text-base"],["href","#",1,"flex-1","p-2","rounded-br-2xl","transition","hover:text-indigo-400",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"a",2),e._uU(3,"Upload Videos"),e.qZA(),e.TgZ(4,"select",3),e.NdJ("change",function(C){return i.sort(C)}),e.TgZ(5,"option",4),e._uU(6,"Recent Uploads "),e.qZA(),e.TgZ(7,"option",5),e._uU(8,"Oldest Uploads "),e.qZA()()()(),e.TgZ(9,"div",6)(10,"div",7),e.YNc(11,R,15,5,"div",8),e.qZA()(),e.TgZ(12,"app-edit",9),e.NdJ("update",function(C){return i.update(C)}),e.qZA()),2&t&&(e.xp6(5),e.Q6J("selected","1"===i.videoOrder),e.xp6(2),e.Q6J("selected","2"===i.videoOrder),e.xp6(4),e.Q6J("ngForOf",i.clips),e.xp6(1),e.Q6J("activeClip",i.activeClip))},dependencies:[v.sg,p.rH,g.YN,g.Kr,ee]}),r})();const D={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let O;const N=new Uint8Array(16);function j(){if(!O&&(O=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!O))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return O(N)}const T=[];for(let r=0;r<256;++r)T.push((r+256).toString(16).slice(1));const ne=function te(r,l,t){if(D.randomUUID&&!l&&!r)return D.randomUUID();const i=(r=r||{}).random||(r.rng||j)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,l){t=t||0;for(let u=0;u<16;++u)l[t+u]=i[u];return l}return function $(r,l=0){return(T[r[l+0]]+T[r[l+1]]+T[r[l+2]]+T[r[l+3]]+"-"+T[r[l+4]]+T[r[l+5]]+"-"+T[r[l+6]]+T[r[l+7]]+"-"+T[r[l+8]]+T[r[l+9]]+"-"+T[r[l+10]]+T[r[l+11]]+T[r[l+12]]+T[r[l+13]]+T[r[l+14]]+T[r[l+15]]).toLowerCase()}(i)};var z=a(2572),Q=a(9315),U=a(4664),F=a(7142),o=a(6240),n=a(6796),s=a(5200);let f=(()=>{class r{constructor(){this.isRunning=!1,this.isReady=!1,this.ffmpeg=(0,s.createFFmpeg)({log:!0})}init(){var t=this;return(0,m.Z)(function*(){t.isReady||(yield t.ffmpeg.load(),t.isReady=!0)})()}getScreenshots(t){var i=this;return(0,m.Z)(function*(){i.isRunning=!0;const u=yield(0,s.fetchFile)(t);i.ffmpeg.FS("writeFile",t.name,u);const C=[1,2,3],S=[];C.forEach(re=>{S.push("-i",t.name,"-ss",`00:00:0${re}`,"-frames:v","1","-filter:v","scale=510:-1",`output_0${re}.png`)}),yield i.ffmpeg.run(...S);const A=[];return C.forEach(re=>{const W=i.ffmpeg.FS("readFile",`output_0${re}.png`),q=new Blob([W.buffer],{type:"image/png"}),X=URL.createObjectURL(q);A.push(X)}),i.isRunning=!1,A})()}blobFromURL(t){return(0,m.Z)(function*(){return yield(yield fetch(t)).blob()})()}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),c=(()=>{class r{handleEvent(t){t.preventDefault()}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275dir=e.lG2({type:r,selectors:[["","app-event-blocker",""]],hostBindings:function(t,i){1&t&&e.NdJ("drop",function(C){return i.handleEvent(C)})("dragover",function(C){return i.handleEvent(C)})}}),r})();var x=a(6593);let E=(()=>{class r{constructor(t){this.sanitizer=t}transform(t){return this.sanitizer.bypassSecurityTrustUrl(t)}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(x.H7,16))},r.\u0275pipe=e.Yjl({name:"safeURL",type:r,pure:!0}),r})();function L(r,l){1&r&&(e.TgZ(0,"span",5),e._uU(1," settings "),e.qZA())}function I(r,l){1&r&&(e.TgZ(0,"span",5),e._uU(1," auto-renew "),e.qZA())}const Z=function(r){return{"bg-indigo-400 border-indigo-400 border-solid":r}};function oe(r,l){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",8),e.NdJ("dragend",function(){e.CHM(t);const u=e.oxw(2);return e.KtG(u.isDragover=!1)})("dragover",function(){e.CHM(t);const u=e.oxw(2);return e.KtG(u.isDragover=!0)})("dragenter",function(){e.CHM(t);const u=e.oxw(2);return e.KtG(u.isDragover=!0)})("dragleave",function(){e.CHM(t);const u=e.oxw(2);return e.KtG(u.isDragover=!1)})("mouseleave",function(){e.CHM(t);const u=e.oxw(2);return e.KtG(u.isDragover=!1)})("drop",function(u){e.CHM(t);const C=e.oxw(2);return e.KtG(C.storeFile(u))}),e.TgZ(2,"h5"),e._uU(3,"Drop your file here (mp4 only!)"),e.qZA(),e.YNc(4,I,2,0,"span",9),e.qZA(),e.TgZ(5,"input",10),e.NdJ("change",function(u){e.CHM(t);const C=e.oxw(2);return e.KtG(C.storeFile(u))}),e.qZA(),e.BQk()}if(2&r){const t=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(2,Z,t.isDragover)),e.xp6(3),e.Q6J("ngIf",t.ffmpegService.isRunning)}}function K(r,l){if(1&r&&(e.TgZ(0,"p"),e._uU(1),e.ALo(2,"percent"),e.qZA()),2&r){const t=e.oxw(4);e.xp6(1),e.Oqu(e.lcZ(2,1,t.percentage))}}function J(r,l){if(1&r&&(e.TgZ(0,"app-alert",21)(1,"p"),e._uU(2),e.qZA(),e.YNc(3,K,3,3,"p",22),e.qZA()),2&r){const t=e.oxw(3);e.Q6J("color",t.alertColor),e.xp6(2),e.Oqu(t.alertMessage),e.xp6(1),e.Q6J("ngIf",t.showPercentage)}}const de=function(r,l){return{"border-green-400":r,"border-transparent":l}};function fe(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",23),e.NdJ("click",function(){const C=e.CHM(t).$implicit,S=e.oxw(3);return e.KtG(S.selectedScreenshot=C)}),e._UZ(1,"img",24),e.ALo(2,"safeURL"),e.qZA()}if(2&r){const t=l.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.WLB(4,de,t===i.selectedScreenshot,t!==i.selectedScreenshot)),e.xp6(1),e.Q6J("src",e.lcZ(2,2,t),e.LSH)}}const ge=function(r,l){return{"opacity-50":r,"hover:bg-indigo-700":l}};function me(r,l){if(1&r){const t=e.EpF();e.YNc(0,J,4,3,"app-alert",11),e.TgZ(1,"form",12),e.NdJ("ngSubmit",function(){e.CHM(t);const u=e.oxw(2);return e.KtG(u.uploadFile())}),e.TgZ(2,"h2",13),e._uU(3,"Select a Thumbnail"),e.qZA(),e.TgZ(4,"div",14),e.YNc(5,fe,3,7,"div",15),e.qZA(),e.TgZ(6,"div",16)(7,"label",17),e._uU(8,"Title"),e.qZA(),e._UZ(9,"app-input",18),e.qZA(),e.TgZ(10,"div",19)(11,"button",20),e._uU(12," Publish "),e.qZA()()()}if(2&r){const t=e.oxw(2);e.Q6J("ngIf",t.showAlert),e.xp6(1),e.Q6J("formGroup",t.uploadForm),e.xp6(4),e.Q6J("ngForOf",t.screenshots),e.xp6(4),e.Q6J("control",t.title),e.xp6(2),e.Q6J("disabled",t.inSubmission)("ngClass",e.WLB(6,ge,t.inSubmission,!t.inSubmission))}}function he(r,l){if(1&r&&(e.YNc(0,oe,6,4,"ng-container",6),e.YNc(1,me,13,9,"ng-template",null,7,e.W1O)),2&r){const t=e.MAs(2),i=e.oxw();e.Q6J("ngIf",!i.nextStep)("ngIfElse",t)}}let ve=(()=>{class r{constructor(t,i,u,C,S){this.storage=t,this.auth=i,this.clipsService=u,this.router=C,this.ffmpegService=S,this.isDragover=!1,this.file=null,this.nextStep=!1,this.showAlert=!1,this.alertColor="blue",this.alertMessage="Please wait! Your clip is being uploaded.",this.inSubmission=!1,this.percentage=0,this.showPercentage=!1,this.user=null,this.screenshots=[],this.selectedScreenshot="",this.title=new g.NI("",[g.kI.required,g.kI.minLength(3)]),this.uploadForm=new g.cw({title:this.title}),i.user.subscribe(A=>this.user=A),this.ffmpegService.init()}ngOnDestroy(){this.task?.cancel()}storeFile(t){var i=this;return(0,m.Z)(function*(){i.ffmpegService.isRunning||(i.isDragover=!1,i.file=t.dataTransfer?t.dataTransfer?.files.item(0)??null:t.target.files?.item(0)??null,i.file&&"video/mp4"===i.file.type&&(i.screenshots=yield i.ffmpegService.getScreenshots(i.file),i.selectedScreenshot=i.screenshots[0],i.title.setValue(i.file.name.replace(/\.[^/.]+$/,"")),i.nextStep=!0))})()}uploadFile(){var t=this;return(0,m.Z)(function*(){t.uploadForm.disable(),t.showAlert=!0,t.alertColor="blue",t.alertMessage="Please wait! Your clip is being uploaded.",t.inSubmission=!0,t.showPercentage=!0;const i=ne(),u=`clips/${i}.mp4`,C=yield t.ffmpegService.blobFromURL(t.selectedScreenshot),S=`screenshot/${i}.png`;t.task=t.storage.upload(u,t.file);const A=t.storage.ref(u);t.screenshotTask=t.storage.upload(S,C);const re=t.storage.ref(S);var W;(0,z.a)([t.task.percentageChanges(),t.screenshotTask.percentageChanges()]).subscribe(W=>{const[q,X]=W;q&&X&&(t.percentage=(q+X)/200)}),(0,Q.D)([t.task.snapshotChanges(),t.screenshotTask.snapshotChanges()]).pipe((0,U.w)(()=>(0,Q.D)([A.getDownloadURL(),re.getDownloadURL()]))).subscribe({next:(W=(0,m.Z)(function*(q){const[X,ce]=q,pe={uid:t.user?.uid,displayName:t.user?.displayName,title:t.title.value,fileName:`${i}.mp4`,url:X,screenshotURL:ce,screenshotFileName:`${i}.png`,timestamp:F.Z.firestore.FieldValue.serverTimestamp()},Fe=yield t.clipsService.createClip(pe);console.log(pe),t.alertColor="green",t.alertMessage="Success! You clip is now ready to share with the world.",t.showPercentage=!1,setTimeout(()=>{t.router.navigate(["clip",Fe.id])},1e3)}),function(X){return W.apply(this,arguments)}),error:W=>{t.uploadForm.enable(),t.alertColor="red",t.alertMessage="Upload failed ! Please try again later (*and remember max size - 25mb) !",t.inSubmission=!0,t.showPercentage=!1,console.error(W)}})})()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(o.Q1),e.Y36(n.zQ),e.Y36(h.Y),e.Y36(p.F0),e.Y36(f))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-upload"]],decls:8,vars:2,consts:[[1,"container","mx-auto","my-8","bg-secondary","p-6"],[1,"rounded","relative","flex","flex-col"],[1,"font-bold","mb-6"],["class","material-icons text-center text-6xl p-8 animate-spin",4,"ngIf","ngIfElse"],["uploadEditorCtr",""],[1,"material-icons","text-center","text-6xl","p-8","animate-spin"],[4,"ngIf","ngIfElse"],["uploadFormCtr",""],["app-event-blocker","",1,"w-full","px-10","py-40","rounded","text-center","cursor-pointer","border","border-dashed","border-gray-400","transition","duration-500","hover:text-white","hover:bg-indigo-400","hover:border-indigo-400","hover:border-solid","text-xl",3,"ngClass","dragend","dragover","dragenter","dragleave","mouseleave","drop"],["class","material-icons text-center text-6xl p-8 animate-spin",4,"ngIf"],["type","file",1,"mt-4",3,"change"],[3,"color",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"mb-4","text-xl"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-4"],["class","border-8 cursor-pointer",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"mt-4"],[1,"block","text-xl","mb-4"],["placeholder","Enter Title",3,"control"],[1,"mt-4","text-right"],["type","submit",1,"inline-flex","justify-center","py-2","px-4","border","border-transparent","shadow-sm","rounded-md","text-white","bg-indigo-600","focus:outline-none",3,"disabled","ngClass"],[3,"color"],[4,"ngIf"],[1,"border-8","cursor-pointer",3,"ngClass","click"],[3,"src"]],template:function(t,i){if(1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2),e._uU(3,"Upload Video"),e.qZA(),e.ynx(4),e.YNc(5,L,2,0,"span",3),e.BQk(),e.YNc(6,he,3,2,"ng-template",null,4,e.W1O),e.qZA()()),2&t){const u=e.MAs(7);e.xp6(5),e.Q6J("ngIf",!i.ffmpegService.isReady)("ngIfElse",u)}},dependencies:[v.mk,v.sg,v.O5,M.a,k.w,c,g._Y,g.JL,g.sg,v.Zx,E]}),r})();var ye=a(8407),se=a(7398),_e=a(8180);const ae=(0,se.U)(r=>!!r);let le=(()=>{class r{constructor(t,i){this.router=t,this.auth=i,this.canActivate=(u,C)=>{const S=u.data.authGuardPipe||(()=>ae);return this.auth.user.pipe((0,_e.q)(1),S(u,C),(0,se.U)(A=>"boolean"==typeof A?A:Array.isArray(A)?this.router.createUrlTree(A):this.router.parseUrl(A)))}}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(p.F0),e.LFG(n.zQ))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"any"}),r})();const ue=()=>("/",(0,ye.z)(ae,(0,se.U)(l=>l||"/"))),xe=[{path:"manage",component:V,data:{authOnly:!0,authGuardPipe:ue},canActivate:[le]},{path:"upload",component:ve,data:{authOnly:!0,authGuardPipe:ue},canActivate:[le]},{path:"manage-clips",redirectTo:"manage"}];let Ce=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[p.Bz.forChild(xe),p.Bz]}),r})();var Te=a(6208);let Ue=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[v.ez,Ce,Te.m,g.UX]}),r})()},7303:_=>{var y=function(a){"use strict";var d,v=Object.prototype,p=v.hasOwnProperty,m=Object.defineProperty||function(o,n,s){o[n]=s.value},e="function"==typeof Symbol?Symbol:{},h=e.iterator||"@@iterator",b=e.asyncIterator||"@@asyncIterator",g=e.toStringTag||"@@toStringTag";function w(o,n,s){return Object.defineProperty(o,n,{value:s,enumerable:!0,configurable:!0,writable:!0}),o[n]}try{w({},"")}catch{w=function(n,s,f){return n[s]=f}}function M(o,n,s,f){var x=Object.create((n&&n.prototype instanceof V?n:V).prototype),E=new Q(f||[]);return m(x,"_invoke",{value:ie(o,s,E)}),x}function k(o,n,s){try{return{type:"normal",arg:o.call(n,s)}}catch(f){return{type:"throw",arg:f}}}a.wrap=M;var P="suspendedStart",Y="suspendedYield",ee="executing",B="completed",R={};function V(){}function G(){}function D(){}var O={};w(O,h,function(){return this});var N=Object.getPrototypeOf,j=N&&N(N(U([])));j&&j!==v&&p.call(j,h)&&(O=j);var T=D.prototype=V.prototype=Object.create(O);function $(o){["next","throw","return"].forEach(function(n){w(o,n,function(s){return this._invoke(n,s)})})}function H(o,n){function s(x,E,L,I){var Z=k(o[x],o,E);if("throw"!==Z.type){var oe=Z.arg,K=oe.value;return K&&"object"==typeof K&&p.call(K,"__await")?n.resolve(K.__await).then(function(J){s("next",J,L,I)},function(J){s("throw",J,L,I)}):n.resolve(K).then(function(J){oe.value=J,L(oe)},function(J){return s("throw",J,L,I)})}I(Z.arg)}var f;m(this,"_invoke",{value:function c(x,E){function L(){return new n(function(I,Z){s(x,E,I,Z)})}return f=f?f.then(L,L):L()}})}function ie(o,n,s){var f=P;return function(x,E){if(f===ee)throw new Error("Generator is already running");if(f===B){if("throw"===x)throw E;return F()}for(s.method=x,s.arg=E;;){var L=s.delegate;if(L){var I=te(L,s);if(I){if(I===R)continue;return I}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(f===P)throw f=B,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);f=ee;var Z=k(o,n,s);if("normal"===Z.type){if(f=s.done?B:Y,Z.arg===R)continue;return{value:Z.arg,done:s.done}}"throw"===Z.type&&(f=B,s.method="throw",s.arg=Z.arg)}}}function te(o,n){var s=n.method,f=o.iterator[s];if(f===d)return n.delegate=null,"throw"===s&&o.iterator.return&&(n.method="return",n.arg=d,te(o,n),"throw"===n.method)||"return"!==s&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+s+"' method")),R;var c=k(f,o.iterator,n.arg);if("throw"===c.type)return n.method="throw",n.arg=c.arg,n.delegate=null,R;var x=c.arg;return x?x.done?(n[o.resultName]=x.value,n.next=o.nextLoc,"return"!==n.method&&(n.method="next",n.arg=d),n.delegate=null,R):x:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,R)}function ne(o){var n={tryLoc:o[0]};1 in o&&(n.catchLoc=o[1]),2 in o&&(n.finallyLoc=o[2],n.afterLoc=o[3]),this.tryEntries.push(n)}function z(o){var n=o.completion||{};n.type="normal",delete n.arg,o.completion=n}function Q(o){this.tryEntries=[{tryLoc:"root"}],o.forEach(ne,this),this.reset(!0)}function U(o){if(o){var n=o[h];if(n)return n.call(o);if("function"==typeof o.next)return o;if(!isNaN(o.length)){var s=-1,f=function c(){for(;++s<o.length;)if(p.call(o,s))return c.value=o[s],c.done=!1,c;return c.value=d,c.done=!0,c};return f.next=f}}return{next:F}}function F(){return{value:d,done:!0}}return G.prototype=D,m(T,"constructor",{value:D,configurable:!0}),m(D,"constructor",{value:G,configurable:!0}),G.displayName=w(D,g,"GeneratorFunction"),a.isGeneratorFunction=function(o){var n="function"==typeof o&&o.constructor;return!!n&&(n===G||"GeneratorFunction"===(n.displayName||n.name))},a.mark=function(o){return Object.setPrototypeOf?Object.setPrototypeOf(o,D):(o.__proto__=D,w(o,g,"GeneratorFunction")),o.prototype=Object.create(T),o},a.awrap=function(o){return{__await:o}},$(H.prototype),w(H.prototype,b,function(){return this}),a.AsyncIterator=H,a.async=function(o,n,s,f,c){void 0===c&&(c=Promise);var x=new H(M(o,n,s,f),c);return a.isGeneratorFunction(n)?x:x.next().then(function(E){return E.done?E.value:x.next()})},$(T),w(T,g,"Generator"),w(T,h,function(){return this}),w(T,"toString",function(){return"[object Generator]"}),a.keys=function(o){var n=Object(o),s=[];for(var f in n)s.push(f);return s.reverse(),function c(){for(;s.length;){var x=s.pop();if(x in n)return c.value=x,c.done=!1,c}return c.done=!0,c}},a.values=U,Q.prototype={constructor:Q,reset:function(o){if(this.prev=0,this.next=0,this.sent=this._sent=d,this.done=!1,this.delegate=null,this.method="next",this.arg=d,this.tryEntries.forEach(z),!o)for(var n in this)"t"===n.charAt(0)&&p.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=d)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(o){if(this.done)throw o;var n=this;function s(I,Z){return x.type="throw",x.arg=o,n.next=I,Z&&(n.method="next",n.arg=d),!!Z}for(var f=this.tryEntries.length-1;f>=0;--f){var c=this.tryEntries[f],x=c.completion;if("root"===c.tryLoc)return s("end");if(c.tryLoc<=this.prev){var E=p.call(c,"catchLoc"),L=p.call(c,"finallyLoc");if(E&&L){if(this.prev<c.catchLoc)return s(c.catchLoc,!0);if(this.prev<c.finallyLoc)return s(c.finallyLoc)}else if(E){if(this.prev<c.catchLoc)return s(c.catchLoc,!0)}else{if(!L)throw new Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return s(c.finallyLoc)}}}},abrupt:function(o,n){for(var s=this.tryEntries.length-1;s>=0;--s){var f=this.tryEntries[s];if(f.tryLoc<=this.prev&&p.call(f,"finallyLoc")&&this.prev<f.finallyLoc){var c=f;break}}c&&("break"===o||"continue"===o)&&c.tryLoc<=n&&n<=c.finallyLoc&&(c=null);var x=c?c.completion:{};return x.type=o,x.arg=n,c?(this.method="next",this.next=c.finallyLoc,R):this.complete(x)},complete:function(o,n){if("throw"===o.type)throw o.arg;return"break"===o.type||"continue"===o.type?this.next=o.arg:"return"===o.type?(this.rval=this.arg=o.arg,this.method="return",this.next="end"):"normal"===o.type&&n&&(this.next=n),R},finish:function(o){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.finallyLoc===o)return this.complete(s.completion,s.afterLoc),z(s),R}},catch:function(o){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.tryLoc===o){var f=s.completion;if("throw"===f.type){var c=f.arg;z(s)}return c}}throw new Error("illegal catch attempt")},delegateYield:function(o,n,s){return this.delegate={iterator:U(o),resultName:n,nextLoc:s},"next"===this.method&&(this.arg=d),R}},a}(_.exports);try{regeneratorRuntime=y}catch{"object"==typeof globalThis?globalThis.regeneratorRuntime=y:Function("r","regeneratorRuntime = r")(y)}},5313:function(_,y,a){var v,p;v=function(){return function m(){var d=arguments.length;if(0===d)throw new Error("resolveUrl requires at least one argument; got none.");var e=document.createElement("base");if(e.href=arguments[0],1===d)return e.href;var h=document.getElementsByTagName("head")[0];h.insertBefore(e,h.firstChild);for(var g,b=document.createElement("a"),w=1;w<d;w++)b.href=arguments[w],e.href=g=b.href;return h.removeChild(e),g}},void 0!==(p=v.call(y,a,y,_))&&(_.exports=p)},7156:_=>{function y(v,p,m,d,e,h,b){try{var g=v[h](b),w=g.value}catch(M){return void m(M)}g.done?p(w):Promise.resolve(w).then(d,e)}_.exports=function a(v){return function(){var p=this,m=arguments;return new Promise(function(d,e){var h=v.apply(p,m);function b(w){y(h,d,e,b,g,"next",w)}function g(w){y(h,d,e,b,g,"throw",w)}b(void 0)})}},_.exports.__esModule=!0,_.exports.default=_.exports},3681:_=>{"use strict";_.exports=JSON.parse('{"name":"@ffmpeg/ffmpeg","version":"0.9.8","description":"FFmpeg WebAssembly version","main":"src/index.js","types":"src/index.d.ts","directories":{"example":"examples"},"scripts":{"start":"node scripts/server.js","build":"rimraf dist && webpack --config scripts/webpack.config.prod.js","prepublishOnly":"npm run build","lint":"eslint src","wait":"rimraf dist && wait-on http://localhost:3000/dist/ffmpeg.dev.js","test":"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:ffmpeg test:node:all","test:node":"node --experimental-wasm-threads --experimental-wasm-bulk-memory node_modules/.bin/_mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser":"mocha-headless-chrome -a allow-file-access-from-files -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:ffmpeg":"npm run test:browser -- -f ./tests/ffmpeg.test.html"},"browser":{"./src/node/index.js":"./src/browser/index.js"},"repository":{"type":"git","url":"git+https://github.com/ffmpegwasm/ffmpeg.wasm.git"},"keywords":["ffmpeg","WebAssembly","video"],"author":"Jerome Wu <jeromewus@gmail.com>","license":"MIT","bugs":{"url":"https://github.com/ffmpegwasm/ffmpeg.wasm/issues"},"engines":{"node":">=12.16.1"},"homepage":"https://github.com/ffmpegwasm/ffmpeg.wasm#readme","dependencies":{"is-url":"^1.2.4","node-fetch":"^2.6.1","regenerator-runtime":"^0.13.7","resolve-url":"^0.2.1"},"devDependencies":{"@babel/core":"^7.12.3","@babel/preset-env":"^7.12.1","@ffmpeg/core":"^0.9.0","@types/emscripten":"^1.39.4","babel-loader":"^8.1.0","chai":"^4.2.0","cors":"^2.8.5","eslint":"^7.12.1","eslint-config-airbnb-base":"^14.1.0","eslint-plugin-import":"^2.22.1","express":"^4.17.1","mocha":"^8.2.1","mocha-headless-chrome":"^2.0.3","npm-run-all":"^4.1.5","wait-on":"^5.3.0","webpack":"^5.3.2","webpack-cli":"^4.1.0","webpack-dev-middleware":"^4.0.0"}}')}}]);